#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
@author: FlyFox
@email: walkandthinker@gmail.com
@discuss: QQ group: 797998860
"""

import numpy as np
import sys

#######################################################
### Define 1D gauss integration rule
#######################################################
def Int1D(ngp):
    # generate 1D gausss integration point and weight
    if ngp<2 or ngp>5:
        sys.exit('Error: unsupported gauss point number(=%d)'%(ngp))
    
    gs=np.zeros((ngp,2))# 0->for w,1->xi

    if ngp == 2:
        gs[0,1] =-0.577350269189625764509148780502
        gs[1,1] = 0.577350269189625764509148780502

        gs[0,0] = 1.0
        gs[1,0] = 1.0
    elif ngp == 3:
        gs[0,0] = 0.555555555555555555555555555556
        gs[0,1] =-0.774596669241483377035853079956

        gs[1,0] = 0.888888888888888888888888888889
        gs[1,1] = 0.0

        gs[2,0] = 0.555555555555555555555555555556
        gs[2,1] = 0.774596669241483377035853079956
    elif ngp == 4:
        gs[0,0] = 0.347854845137453857373063949222
        gs[0,1] =-0.861136311594052575223946488893

        gs[1,0]= 0.652145154862546142626936050778
        gs[1,1]=-0.339981043584856264802665759103

        gs[2,0]= 0.652145154862546142626936050778
        gs[2,1]= 0.339981043584856264802665759103

        gs[3,0]= 0.347854845137453857373063949222
        gs[3,1]= 0.861136311594052575223946488893
    elif ngp==5:
        gs[0,1] = -0.906179845938663992797626878299
        gs[1,1] = -0.538469310105683091036314420700
        gs[2,1] = 0.000000000000000000000000000000
        gs[3,1] = 0.538469310105683091036314420700
        gs[4,1] = 0.906179845938663992797626878299


        gs[0,0] = 0.236926885056189087514264040720
        gs[1,0] = 0.478628670499366468041291514836
        gs[2,0] = 0.568888888888888888888888888889
        gs[3,0] = 0.478628670499366468041291514836
        gs[4,0] = 0.236926885056189087514264040720
    
    
    return gs

#########################################
### Define 2D integration gauss point
#########################################
def Int2D(ngp):
    # generate 1D gausss integration point and weight
    if ngp<2 or ngp>5:
        sys.exit('Error: unsupported gauss point number(=%d)'%(ngp))
    
    gs1d=Int1D(ngp)
    gs=np.zeros((ngp*ngp,3))

    k=0
    for i in range(ngp):
        for j in range(ngp):
            gs[k,0]=gs1d[i,0]*gs1d[j,0]
            gs[k,1]=gs1d[i,1]
            gs[k,2]=gs1d[j,1]
            k+=1
    return gs

